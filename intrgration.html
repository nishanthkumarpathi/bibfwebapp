This file is modified by Nishanth Kumar, fixed all the code from Raees.
Hasan Alsehlawi
Hasan also started working on it.
Some other changes